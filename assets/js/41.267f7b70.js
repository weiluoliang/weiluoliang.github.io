(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{398:function(s,a,t){"use strict";t.r(a);var n=t(15),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),a("p",[s._v("1.arthas可以帮助你定位性能问题：某个方法很慢，你想知道方法中调用各子方法的耗时，2.假如你怀疑运维是否发布了最新版本的代码到生产环境，那么arthas的jad命令可以直接反编译某个类，即可确认跑的代码是不是你最新的代码。")]),s._v(" "),a("p",[s._v("官方文档地址： https://arthas.aliyun.com/")]),s._v(" "),a("h2",{attrs:{id:"使用技巧"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用技巧"}},[s._v("#")]),s._v(" 使用技巧")]),s._v(" "),a("h3",{attrs:{id:"安装idea插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装idea插件"}},[s._v("#")]),s._v(" 安装IDEA插件")]),s._v(" "),a("p",[s._v("命令太多了，有了IDEA插件，使用更高效")]),s._v(" "),a("p",[s._v("Settings ---\x3e  plugins ---\x3e 搜索 ： "),a("code",[s._v("arthas idea")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://images.luoliang.top/blog/20240412105806.png",alt:""}})]),s._v(" "),a("p",[s._v("使用的方式： 在类中点击鼠标右键")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://images.luoliang.top/blog/20240412105923.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"反编译操作-jad"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#反编译操作-jad"}},[s._v("#")]),s._v(" 反编译操作  jad")]),s._v(" "),a("p",[s._v("你可以反编译一个类，也可以只反编译一个类中的某个方法。")]),s._v(" "),a("ol",[a("li",[s._v("编译一个类，在idea中某个类上操作")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://images.luoliang.top/blog/20240412110410.png",alt:""}})]),s._v(" "),a("p",[s._v("获得一个命令：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("jad --source-only com.xxx.xxx.app.xxx.xxx.service.impl.AgentStatisticsExportServiceImpl \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("jad ： 反编译命令")])]),s._v(" "),a("li",[a("p",[s._v("--source-only ： 只打印出来的代码，不")])]),s._v(" "),a("li",[a("p",[s._v("xxx.AgentStatisticsExportServiceImpl   指定要编译的类")])])]),s._v(" "),a("p",[s._v("在机器上去执行该命令")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 下载 arthas-boot.jar")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" https://arthas.aliyun.com/arthas-boot.jar\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 启动 arthas-boot.jar")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-jar")]),s._v(" arthas-boot.jar\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 找到你的程序 ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://images.luoliang.top/blog/20240412140128.png",alt:""}})]),s._v(" "),a("p",[s._v("我这里的是 【12】，控制台输入 12 ，即可进入当前的进程")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("12\n[INFO] arthas home: /root/.arthas/lib/3.7.2/arthas\n[INFO] Try to attach process 6479\n[INFO] Attach process 6479 success.\n[INFO] arthas-client connect 127.0.0.1 3658\n  ,---.  ,------. ,--------.,--.  ,--.  ,---.   ,---.                           \n /  O  \\ |  .--. ''--.  .--'|  '--'  | /  O  \\ '   .-'                          \n|  .-.  ||  '--'.'   |  |   |  .--.  ||  .-.  |`.  `-.                          \n|  | |  ||  |\\  \\    |  |   |  |  |  ||  | |  |.-'    |                         \n`--' `--'`--' '--'   `--'   `--'  `--'`--' `--'`-----'                          \n\nwiki       https://arthas.aliyun.com/doc                                        \ntutorials  https://arthas.aliyun.com/doc/arthas-tutorials.html                  \nversion    3.7.2                                                                \nmain_class                                                                      \npid        6479                                                                 \ntime       2024-04-12 14:03:33                                                  \n\n[arthas@6479]$ jad --source-only xxx.AgentStatisticsAggrServiceImpl \n反编译结果： 略..\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"watch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#watch"}},[s._v("#")]),s._v(" watch")]),s._v(" "),a("p",[s._v("查看方法的入参和返回值")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("watch")]),s._v(" demo.MathGame primeFactors "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-x")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\nAffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("class count: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" , method count: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" cost "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("91")]),s._v(" ms, listenerId: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("method")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("demo.MathGame.primeFactors "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("location")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("AtExceptionExit\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ts")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-04-12 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":58:58"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("cost"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".454144ms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("result")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("@ArrayList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    @Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        @Integer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-31968"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n    @MathGame"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("random")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("@Random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("java.util.Random@7eda2dbb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("illegalArgumentCount")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("@Integer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n    null,\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h3",{attrs:{id:"trace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#trace"}},[s._v("#")]),s._v(" trace")]),s._v(" "),a("p",[s._v("查看方法执行路径并统计耗时")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arthas@31382"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ trace demo.MathGame run\n\nAffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("class count: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" , method count: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" cost "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("54")]),s._v(" ms, listenerId: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("---ts"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-04-12 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":00:12"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("thread_name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("is_daemon")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("priority")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TCCL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sun.misc.Launcher$AppClassLoader@70dea4e\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("---"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".398429ms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" demo.MathGame:run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        `---"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17.46")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".069566ms "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" demo.MathGame:primeFactors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#24 [throws Exception]")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"thread-排查线程问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#thread-排查线程问题"}},[s._v("#")]),s._v(" thread 排查线程问题")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看最繁忙的三个线程 ")]),s._v("\nthread "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看指定线程的堆栈 thread id ")]),s._v("\n thread "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("  \n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# thread -i, 指定采样时间间隔")]),s._v("\nthread "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出 1000ms 内最忙的 3 个线程栈")]),s._v("\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# thread -b, 找出当前阻塞其他线程的线程")]),s._v("\nthread "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h3",{attrs:{id:"dashboard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dashboard"}},[s._v("#")]),s._v(" dashboard")]),s._v(" "),a("p",[s._v("当前系统的实时数据面板, 线程，内存，运行环境，数据实时更新")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[arthas@31382]$ dashboard  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);