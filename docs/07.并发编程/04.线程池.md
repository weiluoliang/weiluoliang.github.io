---
title: 线程池
date: 2022-05-09 14:33:04
permalink: /pages/c59723/
categories:
  - 并发编程
tags:
  - 
author: 
  name: weiluoliang
  link: https://github.com/weiluoliang
---
# 线程池

## 为什么要有线程池

线程的创建和销毁相当的消耗资源，而程序执行的时间其实很短，若每次执行任务都去创建线程，大部分的资源都去创建线程和销毁线程。 如果创建好线程，并不销毁，下次执行任务的时候直接使用已经创建好的线程，就节省了创建线程所耗费的资源。

### 线程池的优点：

- 节省资源： 避免频繁创建线程耗费资源
- 提高响应速度 ： 直接使用创建好的线程去执行任务会更快。
- 便于管理线程： 线程资源是有限的，不能一直创建，如果并发量很高，不断的去创建资源，会导致资源耗尽。 

## 重要参数解析

```java



```



## 任务提交的处理逻辑





## 线程池的最佳实战

### 使用有界队列

《阿里巴巴Java开发手册》中不允许使用 `Executors.newFixedThreadPool()`创建线程池，因为使用了无界队列 `LinkedBlockingQueue` ，如果堆积的任务很多，可能会导致OOM ，所以不推荐使用。`Executors.newCachedThreadPool()` 的最大线程数是 `Integer.MAX_VALUE`,可以认为是没有上限的，每创建一个线程，默认是`1MB`的内存，内存耗尽也会导致OOM



### 线程数的计算

   - CUP密集型 ：  这种类型非常消耗CPU，设置成N（核心数）+1 ，+1是为了防止缺页中断导致CPU空闲
   - IO密集型：这种类型大部分时间都是在处理IO，而IO并不消耗CPU，可以设置为：  2N   



## 参考资料

https://dunwu.github.io/javacore/pages/241a67

